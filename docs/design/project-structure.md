# 工程目录设计

本文档描述了 Maltose 框架的工程目录结构设计，帮助开发者理解框架的组织方式和各个模块的职责。

## 框架目录结构

Maltose 框架采用模块化设计，各个功能模块按照职责和功能进行划分。下面是主要目录结构及其说明：

```
maltose/
├── cmd/                  # 命令行工具
├── container/            # 容器相关功能
│   ├── minstance/        # 实例管理
│   ├── mmap/             # Map容器
│   └── mvar/             # 变量处理
├── contrib/              # 外部集成与贡献
├── database/             # 数据库相关
│   └── mdb/              # 数据库操作模块
│       └── internal/     # 内部实现
├── errors/               # 错误处理
├── frame/                # 应用框架
│   ├── m/                # 框架快捷方法
│   └── mins/             # 实例管理器
├── internal/             # 内部实现
├── net/                  # 网络相关
│   ├── mclient/          # HTTP客户端
│   ├── mhttp/            # HTTP服务器
│   ├── mipv4/            # IPv4工具
│   └── mtrace/           # 链路追踪
├── os/                   # 系统相关
│   ├── mcfg/             # 配置管理
│   ├── mlog/             # 日志系统
│   └── mmetric/          # 指标监控
└── util/                 # 工具类
```

## 目录命名规范

Maltose 框架的目录命名遵循以下规范：

1. **核心目录**：采用功能分类命名，如 `database`、`net`、`os` 等
2. **子模块目录**：以 `m` 开头，后跟功能名称，如 `mhttp`、`mlog`、`mcfg` 等
3. **内部实现目录**：使用 `internal` 表示包内不对外暴露的实现
4. **工具目录**：使用 `util` 或功能性名称

## 各主要模块说明

### 容器模块 (container)

- **minstance**: 提供实例管理能力，支持单例和命名实例
- **mmap**: 封装了各种 Map 类型的安全实现
- **mvar**: 提供变量类型转换和处理功能

### 数据库模块 (database)

- **mdb**: 封装了 GORM，提供数据库操作能力

### 框架模块 (frame)

- **mins**: 提供应用实例管理，包括服务器、数据库等
- **m**: 提供框架级别的快捷方法

### 网络模块 (net)

- **mhttp**: 基于 Gin 构建的 HTTP 服务器
- **mclient**: HTTP 客户端
- **mtrace**: 链路追踪实现

### 系统模块 (os)

- **mcfg**: 配置管理
- **mlog**: 日志系统
- **mmetric**: 指标监控

## 设计理念

Maltose 框架的目录结构设计遵循以下原则：

1. **关注点分离**：按照功能和职责划分模块
2. **模块独立**：各模块可独立使用，减少依赖
3. **统一入口**：提供统一的接口和使用方式
4. **灵活扩展**：支持自定义扩展和替换实现
5. **符合直觉**：目录和包名应当直观反映其功能

## 应用项目结构建议

基于 Maltose 框架开发应用时，推荐采用以下项目结构：

```
your-app/
├── api/                  # API定义和接口文档
├── cmd/                  # 命令行入口
│   └── server/           # 服务器入口
├── config/               # 配置文件
├── internal/             # 内部实现
│   ├── controller/       # 控制器
│   ├── middleware/       # 中间件
│   ├── model/            # 数据模型
│   ├── repository/       # 数据访问层
│   └── service/          # 业务逻辑层
├── pkg/                  # 可重用的包
├── scripts/              # 构建和部署脚本
└── test/                 # 测试
```

## 最佳实践

- 保持层次结构清晰，避免过深的嵌套
- 依赖注入而非全局状态
- 使用适当的抽象和接口
- 关注横切关注点，如日志、监控、追踪等
- 一致的命名规范和代码风格

通过遵循这些设计原则和结构，可以构建出易于维护、扩展和测试的应用程序。
